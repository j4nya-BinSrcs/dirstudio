<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DirStudio - Directory Intelligence Platform</title>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500;9..40,600;9..40,700;9..40,800&family=DM+Mono:wght@300;400;500&display=swap" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
</head>
<body>

    <div id="header-container"></div>

    <div class="main-container">
        <div id="sidebar-container"></div>

        <main class="content-area">
            <!-- Tab Bar -->
            <div class="tabs-container">
                <ul class="nav nav-tabs" id="mainTabs" role="tablist">
                    <li class="nav-item">
                        <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#overview">
                            <i class="fas fa-chart-line"></i><span>Overview</span>
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tree">
                            <i class="fas fa-folder-tree"></i><span>Tree</span>
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#organize">
                            <i class="fas fa-boxes-stacked"></i><span>Organize</span>
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#transform">
                            <i class="fas fa-wand-magic-sparkles"></i><span>Transform</span>
                        </button>
                    </li>
                </ul>
            </div>

            <div class="tab-content-area">
                <div class="tab-content">

                    <!-- ══════════════════════════════════════════
                         OVERVIEW TAB
                    ══════════════════════════════════════════ -->
                    <div class="tab-pane fade show active" id="overview">

                        <!-- Row 1: Core stats -->
                        <div class="row g-3 mb-4">
                            <div class="col-md-4">
                                <div class="stat-card">
                                    <div class="stat-icon stat-icon--files">
                                        <i class="fas fa-file-lines"></i>
                                    </div>
                                    <div class="stat-content">
                                        <div class="stat-label">Total Files</div>
                                        <div class="stat-value" id="totalFiles">—</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="stat-card">
                                    <div class="stat-icon stat-icon--size">
                                        <i class="fas fa-weight-scale"></i>
                                    </div>
                                    <div class="stat-content">
                                        <div class="stat-label">Total Size</div>
                                        <div class="stat-value" id="totalSize">—</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="stat-card">
                                    <div class="stat-icon stat-icon--dirs">
                                        <i class="fas fa-folder-open"></i>
                                    </div>
                                    <div class="stat-content">
                                        <div class="stat-label">Directories</div>
                                        <div class="stat-value" id="totalDirs">—</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Row 2: Charts (side-by-side, balanced) -->
                        <div class="row g-3 mb-4 align-items-stretch">

                            <!-- File Categories (Primary) -->
                            <div class="col-lg-7">
                                <div class="content-card h-100">
                                    <div class="content-card-title">
                                        <i class="fas fa-chart-pie me-2"></i>File Categories
                                    </div>
                                    <div class="chart-wrap" style="height: 280px;">
                                        <canvas id="fileTypeChart"></canvas>
                                    </div>
                                </div>
                            </div>

                            <!-- Top Extensions -->
                            <div class="col-lg-5">
                                <div class="content-card h-100">
                                    <div class="content-card-title">
                                        <i class="fas fa-ranking-star me-2"></i>Most Common File Types
                                    </div>
                                    <div id="extensionsList" class="ext-list"></div>
                                </div>
                            </div>

                        </div>

                        <!-- Row 3: Scan Details (full width) -->
                        <div class="row g-3">
                            <div class="col-12">
                                <div class="content-card">
                                    <div class="content-card-title">
                                        <i class="fas fa-circle-info me-2"></i>Scan Details
                                    </div>
                                    <div id="scanInfoCard">
                                        <div class="info-empty">
                                            <i class="fas fa-folder-magnifying-glass"></i>
                                            <p>Select a scan to view details</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <!-- ══════════════════════════════════════════
                         TREE TAB — two-panel, no checkboxes on tree
                    ══════════════════════════════════════════ -->
                    <div class="tab-pane fade" id="tree">
                        <div class="tree-layout">

                            <!-- Left panel: tree -->
                            <div class="tree-panel-left content-card">
                                <div class="tree-panel-header">
                                    <div class="content-card-title mb-0">
                                        <i class="fas fa-folder-tree me-2"></i>Directory Structure
                                    </div>
                                    <div class="tree-toolbar">
                                        <button class="tree-tool-btn" id="treeExpandAll" title="Expand all">
                                            <i class="fas fa-angle-double-down"></i>
                                        </button>
                                        <button class="tree-tool-btn" id="treeCollapseAll" title="Collapse all">
                                            <i class="fas fa-angle-double-up"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="tree-scroll">
                                    <div id="directoryTree" class="directory-tree"></div>
                                </div>
                            </div>

                            <!-- Right panel: preview -->
                            <div class="tree-panel-right content-card" id="previewPanel">
                                <div class="preview-empty" id="previewEmpty">
                                    <div class="preview-empty-icon">
                                        <i class="fas fa-hand-pointer"></i>
                                    </div>
                                    <p>Click any file or folder<br>to see its details</p>
                                </div>
                                <div class="preview-content" id="previewContent" style="display:none">
                                    <div class="preview-hero" id="previewHero"></div>
                                    <div class="preview-name" id="previewName"></div>
                                    <div class="preview-rows" id="previewRows"></div>
                                </div>
                            </div>

                        </div>
                    </div><!-- /tree -->

                    <!-- ══════════════════════════════════════════
                         ORGANIZE TAB
                    ══════════════════════════════════════════ -->
                    <div class="tab-pane fade" id="organize">
                        <ul class="nav nav-pills mb-3" role="tablist">
                            <li class="nav-item">
                                <button class="nav-link active" data-bs-toggle="pill" data-bs-target="#duplicates">
                                    <i class="fas fa-copy me-2"></i>Duplicates
                                </button>
                            </li>
                            <li class="nav-item">
                                <button class="nav-link" data-bs-toggle="pill" data-bs-target="#aiSuggestions">
                                    <i class="fas fa-brain me-2"></i>AI Suggestions
                                </button>
                            </li>
                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane fade show active" id="duplicates">
                                <div class="content-card">
                                    <div class="d-flex justify-content-between align-items-center mb-4">
                                        <div class="content-card-title mb-0">
                                            <i class="fas fa-copy me-2"></i>Duplicates &amp; Analysis
                                        </div>
                                        <div class="btn-group">
                                            <button class="btn btn-outline-primary btn-sm" onclick="selectAllDuplicates()">
                                                <i class="fas fa-check-double me-1"></i>Select All
                                            </button>
                                            <button class="btn btn-danger btn-sm" onclick="cleanDuplicates()">
                                                <i class="fas fa-trash me-1"></i>Clean Selected
                                            </button>
                                        </div>
                                    </div>
                                    <div id="duplicateGroups"></div>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="aiSuggestions">
                                <div class="content-card">
                                    <div class="d-flex justify-content-between align-items-center mb-4">
                                        <div class="content-card-title mb-0">
                                            <i class="fas fa-brain me-2"></i>AI Organization Suggestions
                                        </div>
                                        <button class="btn btn-primary btn-sm" onclick="generateAISuggestions()">
                                            <i class="fas fa-magic me-1"></i>Generate Suggestions
                                        </button>
                                    </div>
                                    <div id="aiSuggestionsContent">
                                        <div class="empty-state">
                                            <i class="fas fa-lightbulb"></i>
                                            <p>Click "Generate Suggestions" to get AI-powered recommendations</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><!-- /organize -->

                    <!-- ══════════════════════════════════════════
                         TRANSFORM TAB
                    ══════════════════════════════════════════ -->
                    <div class="tab-pane fade" id="transform">
                        <div class="content-card">
                            <div class="content-card-title">
                                <i class="fas fa-wand-magic-sparkles me-2"></i>File Transformations
                            </div>
                            <div class="row g-3 mt-2">
                                <div class="col-md-4">
                                    <div class="transform-card">
                                        <div class="transform-icon"><i class="fas fa-file-zipper"></i></div>
                                        <h5>Compress</h5>
                                        <p>Create ZIP or TAR archives</p>
                                        <button class="btn btn-primary btn-sm" onclick="openCompressModal()">
                                            <i class="fas fa-compress me-1"></i>Compress Files
                                        </button>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="transform-card">
                                        <div class="transform-icon"><i class="fas fa-exchange-alt"></i></div>
                                        <h5>Convert</h5>
                                        <p>Convert image formats</p>
                                        <button class="btn btn-primary btn-sm" onclick="openConvertModal()">
                                            <i class="fas fa-arrows-rotate me-1"></i>Convert Images
                                        </button>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="transform-card">
                                        <div class="transform-icon"><i class="fas fa-crop"></i></div>
                                        <h5>Resize</h5>
                                        <p>Resize images in bulk</p>
                                        <button class="btn btn-primary btn-sm" onclick="openResizeModal()">
                                            <i class="fas fa-expand me-1"></i>Resize Images
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div id="transformResults" class="mt-4" style="display:none">
                                <div class="content-card-title">
                                    <i class="fas fa-list-check me-2"></i>Transform Results
                                </div>
                                <div id="transformResultsContent"></div>
                            </div>
                        </div>
                    </div><!-- /transform -->

                </div><!-- /tab-content -->
            </div><!-- /tab-content-area -->
        </main>
    </div><!-- /main-container -->

    <div id="footer-container"></div>

    <!-- ═══ MODALS ═══════════════════════════════════════════════════ -->

    <!-- Compress -->
    <div class="modal fade" id="compressModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-file-zipper me-2"></i>Compress Files</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-5">
                            <h6 class="mb-2">Select Files</h6>
                            <div class="modal-tree-wrap" id="compressTreeContainer"></div>
                        </div>
                        <div class="col-md-7">
                            <div class="mb-3"><label class="form-label">Selected: <span id="compressFileCount">0</span> files</label></div>
                            <div class="mb-3">
                                <label class="form-label">Archive Name</label>
                                <input type="text" class="form-control" id="compressArchiveName" placeholder="archive.zip">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Format</label>
                                <select class="form-select" id="compressFormat">
                                    <option value="zip">ZIP</option>
                                    <option value="tar">TAR.GZ</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Output Directory</label>
                                <input type="text" class="form-control" id="compressOutputDir" placeholder="Leave empty for default">
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="compressDryRun">
                                <label class="form-check-label" for="compressDryRun">Dry Run (no changes)</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="executeCompress()">
                        <i class="fas fa-compress me-1"></i>Compress
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Convert -->
    <div class="modal fade" id="convertModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-exchange-alt me-2"></i>Convert Images</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-5">
                            <h6 class="mb-2">Select Files</h6>
                            <div class="modal-tree-wrap" id="convertTreeContainer"></div>
                        </div>
                        <div class="col-md-7">
                            <div class="mb-3"><label class="form-label">Selected: <span id="convertFileCount">0</span> files</label></div>
                            <div class="mb-3">
                                <label class="form-label">Target Format</label>
                                <select class="form-select" id="convertFormat">
                                    <option value="jpg">JPEG</option>
                                    <option value="png">PNG</option>
                                    <option value="webp">WebP</option>
                                    <option value="bmp">BMP</option>
                                    <option value="gif">GIF</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Output Directory</label>
                                <input type="text" class="form-control" id="convertOutputDir" placeholder="Same as source">
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="convertDryRun">
                                <label class="form-check-label" for="convertDryRun">Dry Run (no changes)</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="executeConvert()">
                        <i class="fas fa-arrows-rotate me-1"></i>Convert
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Resize -->
    <div class="modal fade" id="resizeModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-crop me-2"></i>Resize Images</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-5">
                            <h6 class="mb-2">Select Files</h6>
                            <div class="modal-tree-wrap" id="resizeTreeContainer"></div>
                        </div>
                        <div class="col-md-7">
                            <div class="mb-3"><label class="form-label">Selected: <span id="resizeFileCount">0</span> files</label></div>
                            <div class="row">
                                <div class="col-6 mb-3">
                                    <label class="form-label">Max Width (px)</label>
                                    <input type="number" class="form-control" id="resizeMaxWidth" value="1920" min="1">
                                </div>
                                <div class="col-6 mb-3">
                                    <label class="form-label">Max Height (px)</label>
                                    <input type="number" class="form-control" id="resizeMaxHeight" value="1080" min="1">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Output Directory</label>
                                <input type="text" class="form-control" id="resizeOutputDir" placeholder="Same as source">
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="resizeDryRun">
                                <label class="form-check-label" for="resizeDryRun">Dry Run (no changes)</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="executeResize()">
                        <i class="fas fa-expand me-1"></i>Resize
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/api.js"></script>
    <script src="js/components.js"></script>
    <script src="js/app.js"></script>
</body>
</html>