<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DirStudio - Directory Intelligence Platform</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="css/styles.css" rel="stylesheet">

    <!-- Google Fonts - Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header Component -->
    <div id="header-container"></div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar Component -->
        <div id="sidebar-container"></div>

        <!-- Content Area -->
        <main class="content-area">
            <!-- Tabs Navigation -->
            <div class="tabs-container">
                <ul class="nav nav-tabs" id="mainTabs" role="tablist">
                    <li class="nav-item">
                        <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#overview">
                            <i class="fas fa-chart-line"></i>
                            <span>Overview</span>
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tree">
                            <i class="fas fa-folder-tree"></i>
                            <span>Tree</span>
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#organize">
                            <i class="fas fa-boxes-stacked"></i>
                            <span>Organize</span>
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#transform">
                            <i class="fas fa-wand-magic-sparkles"></i>
                            <span>Transform</span>
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#snapshots">
                            <i class="fas fa-clock-rotate-left"></i>
                            <span>Snapshots</span>
                        </button>
                    </li>
                </ul>
            </div>

            <!-- Tab Content -->
            <div class="tab-content-area">
                <div class="tab-content">
                    <!-- Overview Tab -->
                    <div class="tab-pane fade show active" id="overview">
                        <div class="row g-3 mb-4">
                            <div class="col-md-4">
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-file"></i>
                                    </div>
                                    <div class="stat-content">
                                        <div class="stat-label">Total Files</div>
                                        <div class="stat-value" id="totalFiles">0</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-database"></i>
                                    </div>
                                    <div class="stat-content">
                                        <div class="stat-label">Total Size</div>
                                        <div class="stat-value" id="totalSize">0 B</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-folder"></i>
                                    </div>
                                    <div class="stat-content">
                                        <div class="stat-label">Directories</div>
                                        <div class="stat-value" id="totalDirs">0</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="content-card">
                                    <div class="content-card-title">
                                        <i class="fas fa-chart-pie me-2"></i>
                                        File Type Distribution
                                    </div>
                                    <canvas id="fileTypeChart" class="chart-container"></canvas>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="content-card">
                                    <div class="content-card-title">
                                        <i class="fas fa-list-ul me-2"></i>
                                        File Extensions
                                    </div>
                                    <div id="extensionsList"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tree Tab -->
                    <div class="tab-pane fade" id="tree">
                        <div class="content-card tree-card">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <div class="content-card-title mb-0">
                                    <i class="fas fa-folder-tree me-2"></i>
                                    Directory Structure
                                </div>
                                <div>
                                    <span id="selectedFilesCount" class="badge bg-primary me-2">0 selected</span>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="clearSelection()">
                                        <i class="fas fa-times me-1"></i>Clear
                                    </button>
                                </div>
                            </div>
                            <div class="tree-container">
                                <div id="directoryTree" class="directory-tree"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Organize Tab -->
                    <div class="tab-pane fade" id="organize">
                        <!-- Sub-tabs for Organize -->
                        <ul class="nav nav-pills mb-3" id="organizeTabs" role="tablist">
                            <li class="nav-item">
                                <button class="nav-link active" data-bs-toggle="pill" data-bs-target="#duplicates">
                                    <i class="fas fa-copy me-2"></i>Duplicates
                                </button>
                            </li>
                            <li class="nav-item">
                                <button class="nav-link" data-bs-toggle="pill" data-bs-target="#aiSuggestions">
                                    <i class="fas fa-brain me-2"></i>AI Suggestions
                                </button>
                            </li>
                            <li class="nav-item">
                                <button class="nav-link" data-bs-toggle="pill" data-bs-target="#analysis">
                                    <i class="fas fa-chart-bar me-2"></i>Analysis
                                </button>
                            </li>
                        </ul>

                        <div class="tab-content">
                            <!-- Duplicates Sub-tab -->
                            <div class="tab-pane fade show active" id="duplicates">
                                <div class="content-card">
                                    <div class="d-flex justify-content-between align-items-center mb-4">
                                        <div class="content-card-title mb-0">
                                            <i class="fas fa-copy me-2"></i>
                                            Duplicate Files
                                        </div>
                                        <div class="btn-group">
                                            <button class="btn btn-outline-primary btn-sm" onclick="selectAllDuplicates()">
                                                <i class="fas fa-check-double me-2"></i>Select All
                                            </button>
                                            <button class="btn btn-danger btn-sm" onclick="cleanDuplicates()">
                                                <i class="fas fa-trash me-2"></i>Clean Selected
                                            </button>
                                        </div>
                                    </div>
                                    <div id="duplicateGroups"></div>
                                </div>
                            </div>

                            <!-- AI Suggestions Sub-tab -->
                            <div class="tab-pane fade" id="aiSuggestions">
                                <div class="content-card">
                                    <div class="d-flex justify-content-between align-items-center mb-4">
                                        <div class="content-card-title mb-0">
                                            <i class="fas fa-brain me-2"></i>
                                            AI Organization Suggestions
                                        </div>
                                        <button class="btn btn-primary btn-sm" onclick="generateAISuggestions()">
                                            <i class="fas fa-magic me-2"></i>Generate Suggestions
                                        </button>
                                    </div>
                                    <div id="aiSuggestionsContent">
                                        <div class="empty-state">
                                            <i class="fas fa-lightbulb"></i>
                                            <p>Click "Generate Suggestions" to get AI-powered organization recommendations</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Analysis Sub-tab -->
                            <div class="tab-pane fade" id="analysis">
                                <div class="content-card">
                                    <div class="content-card-title">
                                        <i class="fas fa-chart-bar me-2"></i>
                                        File Statistics
                                    </div>
                                    <div id="analysisStats"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Transform Tab -->
                    <div class="tab-pane fade" id="transform">
                        <div class="content-card">
                            <div class="content-card-title">
                                <i class="fas fa-wand-magic-sparkles me-2"></i>
                                File Transformations
                            </div>
                            <div class="row g-3 mt-3">
                                <div class="col-md-4">
                                    <div class="transform-option">
                                        <div class="transform-icon">
                                            <i class="fas fa-file-zipper"></i>
                                        </div>
                                        <h5>Compress</h5>
                                        <p>Create ZIP or TAR archives</p>
                                        <button class="btn btn-primary btn-sm" onclick="openCompressModal()">
                                            <i class="fas fa-compress me-2"></i>Compress Files
                                        </button>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="transform-option">
                                        <div class="transform-icon">
                                            <i class="fas fa-exchange-alt"></i>
                                        </div>
                                        <h5>Convert</h5>
                                        <p>Convert image formats</p>
                                        <button class="btn btn-primary btn-sm" onclick="openConvertModal()">
                                            <i class="fas fa-arrows-rotate me-2"></i>Convert Images
                                        </button>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="transform-option">
                                        <div class="transform-icon">
                                            <i class="fas fa-crop"></i>
                                        </div>
                                        <h5>Resize</h5>
                                        <p>Resize images in bulk</p>
                                        <button class="btn btn-primary btn-sm" onclick="openResizeModal()">
                                            <i class="fas fa-expand me-2"></i>Resize Images
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Transform Results -->
                            <div id="transformResults" class="mt-4" style="display: none;">
                                <div class="content-card-title">
                                    <i class="fas fa-list-check me-2"></i>
                                    Transform Results
                                </div>
                                <div id="transformResultsContent"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Snapshots Tab -->
                    <div class="tab-pane fade" id="snapshots">
                        <div class="content-card">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <div class="content-card-title mb-0">
                                    <i class="fas fa-clock-rotate-left me-2"></i>
                                    Scan Snapshots
                                </div>
                                <button class="btn btn-primary btn-sm" onclick="createSnapshot()">
                                    <i class="fas fa-camera me-2"></i>Create Snapshot
                                </button>
                            </div>
                            <div id="snapshotsList"></div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Footer Component -->
    <div id="footer-container"></div>

    <!-- Compress Modal with Side Tree -->
    <div class="modal fade modal-lg" id="compressModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-file-zipper me-2"></i>Compress Files</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-5">
                            <h6 class="mb-3">Select Files</h6>
                            <div class="modal-tree-container" id="compressTreeContainer"></div>
                        </div>
                        <div class="col-md-7">
                            <div class="mb-3">
                                <label class="form-label">Selected Files: <span id="compressFileCount">0</span></label>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Archive Name</label>
                                <input type="text" class="form-control" id="compressArchiveName" placeholder="archive.zip">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Format</label>
                                <select class="form-select" id="compressFormat">
                                    <option value="zip">ZIP</option>
                                    <option value="tar">TAR.GZ</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Output Directory</label>
                                <input type="text" class="form-control" id="compressOutputDir" placeholder="Leave empty for default">
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="compressDryRun">
                                <label class="form-check-label" for="compressDryRun">
                                    Dry Run (test without making changes)
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="executeCompress()">
                        <i class="fas fa-compress me-2"></i>Compress
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Convert Modal with Side Tree -->
    <div class="modal fade modal-lg" id="convertModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-exchange-alt me-2"></i>Convert Images</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-5">
                            <h6 class="mb-3">Select Files</h6>
                            <div class="modal-tree-container" id="convertTreeContainer"></div>
                        </div>
                        <div class="col-md-7">
                            <div class="mb-3">
                                <label class="form-label">Selected Files: <span id="convertFileCount">0</span></label>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Target Format</label>
                                <select class="form-select" id="convertFormat">
                                    <option value="jpg">JPEG</option>
                                    <option value="png">PNG</option>
                                    <option value="webp">WebP</option>
                                    <option value="bmp">BMP</option>
                                    <option value="gif">GIF</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Output Directory</label>
                                <input type="text" class="form-control" id="convertOutputDir" placeholder="Leave empty for same directory">
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="convertDryRun">
                                <label class="form-check-label" for="convertDryRun">
                                    Dry Run (test without making changes)
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="executeConvert()">
                        <i class="fas fa-arrows-rotate me-2"></i>Convert
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Resize Modal with Side Tree -->
    <div class="modal fade modal-lg" id="resizeModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-crop me-2"></i>Resize Images</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-5">
                            <h6 class="mb-3">Select Files</h6>
                            <div class="modal-tree-container" id="resizeTreeContainer"></div>
                        </div>
                        <div class="col-md-7">
                            <div class="mb-3">
                                <label class="form-label">Selected Files: <span id="resizeFileCount">0</span></label>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Max Width (px)</label>
                                    <input type="number" class="form-control" id="resizeMaxWidth" value="1920" min="1">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Max Height (px)</label>
                                    <input type="number" class="form-control" id="resizeMaxHeight" value="1080" min="1">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Output Directory</label>
                                <input type="text" class="form-control" id="resizeOutputDir" placeholder="Leave empty for same directory">
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="resizeDryRun">
                                <label class="form-check-label" for="resizeDryRun">
                                    Dry Run (test without making changes)
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="executeResize()">
                        <i class="fas fa-expand me-2"></i>Resize
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>
    <!-- Chart.js for Pie Chart -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- Custom JS -->
    <script src="js/utils.js"></script>
    <script src="js/api.js"></script>
    <script src="js/components.js"></script>
    <script src="js/app.js"></script>
</body>
</html>